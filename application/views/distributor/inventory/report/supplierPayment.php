<?phpif (isset($_POST['start_date'])):    $customerid = $this->input->post('customerid');    $from_date = $this->input->post('start_date');    $to_date = $this->input->post('end_date');endif;?><div class="row">    <div class="col-sm-12">        <div class="portlet box blue">            <div class="portlet-title" style="min-height:21px">                <div class="caption" style="font-size: 14px;padding:1px 0 1px;">                    <?php echo get_phrase('Supplier Payment') ?> </div>            </div>            <div class="portlet-body">                <form id="publicForm" action="" method="post" class="form-horizontal">                    <div class="col-sm-12 col-md-4" style="margin-top: 10px;">                        <div class="form-group">                            <label class="col-sm-3 control-label formfonterp" for="form-field-1"> <span                                        style="color:red;">*</span><strong><?php echo get_phrase('Supplier') ?></strong></label>                            <div class="col-sm-7">                                <input type="hidden" name="date" value="<?php echo date('Y-m-d'); ?>"/>                                <select name="supplierid" class="chosen-select form-control supplierid" id="supplierId"                                        data-placeholder="Search by Supplier ID" required>                                    <option value=""></option>                                    <?php foreach ($supplierList as $eachInfo): ?>                                        <option <?php                                        if (!empty($customerid) && $customerid == $eachInfo->customer_id) {                                            echo "selected";                                        }                                        ?> value="<?php echo $eachInfo->sup_id; ?>"><?php echo $eachInfo->supName; ?>                                            [<?php echo $eachInfo->supID; ?>]                                        </option>                                    <?php endforeach; ?>                                </select>                            </div>                        </div>                        <div class="clearfix"></div>                        <div class="form-group">                            <label class="col-sm-3 control-label formfonterp" for="form-field-1"                                   style="white-space: nowrap;"><strong><?php echo get_phrase('Payment Type') ?></strong></label>                            <div class="col-sm-7">                                <select onchange="showBankinfo(this.value)" name="payType"                                        class="chosen-select form-control"                                        id="paymentType" data-placeholder="Select Payment Type">                                    <option selected value="1">Cash</option>                                    <option value="2">Bank</option>                                </select>                            </div>                        </div>                    </div>                    <div class="col-md-4" style="margin-top: 10px;">                        <div class="form-group">                            <label class="col-sm-3 control-label text-right formfonterp"                                   for="form-field-1"><strong><?php echo get_phrase('Branch') ?></strong></label>                            <div class="col-sm-7">                                <select name="branch_id" class="chosen-select form-control"                                        id="BranchAutoId" data-placeholder="Select Branch">                                    <?php                                    // come from branch_dropdown_helper                                    echo branch_dropdown(null, null);                                    ?>                                </select>                            </div>                        </div>                        <div class="form-group">                            <label class="col-sm-3 control-label text-right formfonterp"                                   for="form-field-1"><strong><?php echo get_phrase('Receipt Id') ?></strong></label>                            <div class="col-sm-7">                                <input readonly type="text" class="form-control" name="receiptId"                                       value="<?php echo $voucherId; ?>" placeholder=""/>                            </div>                        </div>                        <div class="clearfix"></div>                        <div class="clearfix"></div>                        <div class="form-group" id="cashInfo">                            <label class="col-sm-3 control-label formfonterp" for=""                                   style="white-space: nowrap;"><span                                        style="color:red;">*</span><strong> <?php echo get_phrase('Pay_From') ?> </strong>                            </label>                            <div class="col-sm-7">                                <select name="accountCr" class="chosen-select form-control checkAccountBalance"                                        id="accountHead" data-placeholder="Search by Account Head">                                    <option value=""></option>                                    <?php                                    foreach ($accountHeadList as $key => $head) {                                        ?>                                        <optgroup                                                label="<?php echo get_phrase($head['parentName']); ?>">                                            <?php                                            foreach ($head['Accountledger'] as $eachLedger) :                                                ?>                                                <option <?php                                                if ($eachLedger->id == '23') {                                                    echo "selected";                                                }                                                ?> value="<?php echo $eachLedger->id; ?>"><?php echo get_phrase($eachLedger->parent_name) . " ( " . $eachLedger->code . " ) "; ?></option>                                            <?php endforeach; ?>                                        </optgroup>                                        <?php                                    }                                    ?>                                </select>                            </div>                        </div>                    </div>                    <div class="col-md-4" id="cashInfo" style="margin-top: 10px;">                        <div class="form-group">                            <label class="col-sm-3 control-label formfonterp" for="form-field-1"                                   style="white-space: nowrap;"><span                                        style="color:red;"> * </span><strong> <?php echo get_phrase('Payment Date') ?></strong></label>                            <div class="col-sm-7">                                <input type="text" class="date-picker form-control" id="start_date" name="paymentDate"                                       value="<?php                                       if (!empty($from_date)) {                                           echo $from_date;                                       } else {                                           echo date('d-m-Y');                                       }                                       ?>" data-date-format='dd-mm-yyyy' placeholder="Start Date: dd-mm-yyyy" required/>                            </div>                        </div>                        <div class="clearfix"></div>                        <div class="form-group">                            <span id="accountBalance"></span>                        </div>                    </div>                    <div class="col-md-12" id="showBankInfo" style="display: none;">                        <div class="col-md-4">                            <div class="form-group" style="margin-left: -29px;">                                <label class="col-sm-3 control-label formfonterp" for="form-field-1">                                    <strong><?php echo get_phrase('Bank Name') ?></strong></label>                                <div class="col-sm-7">                                    <select name="bankName" class=" form-control" id="bankName"                                            onchange="getBankBranch(this.value)"                                            data-placeholder="Bank Name">                                        <?php                                        echo bank_account_info_dropdown();                                        ?>                                    </select>                                </div>                            </div>                        </div>                        <div class="col-md-2">                            <div class="form-group">                                <label class="col-sm-4 formfonterp"                                       style="white-space: nowrap;padding-top: 7px;"><strong><?php echo get_phrase('Check No') ?></strong></label>                                <div class="col-sm-8">                                    <input type="text" class="form-control  required" autocomplete="off"                                           placeholder="Check NO" id="checkNo" name="checkNo" value="">                                </div>                            </div>                        </div>                        <div class="col-md-2">                            <div class="form-group">                                <label class="col-sm-4  formfonterp"                                       style="white-space: nowrap;padding-top: 7px;"><strong><?php echo get_phrase('Check Date') ?>                                        /strong></label>                                <div class="col-sm-8">                                    <input type="text" class="date-picker form-control" autocomplete="off"                                           id="checkDate" name="date" value="<?php                                    if (!empty($from_date)) {                                        echo $from_date;                                    } else {                                        echo date('d-m-Y');                                    }                                    ?>" data-date-format='dd-mm-yyyy' placeholder="Start Date: dd-mm-yyyy"/>                                </div>                            </div>                        </div>                    </div>                    <div class="col-md-12" id="" style="">                        <div class="col-md-4">                            <div class="form-group" style="margin-left: -29px;">                                <label class="col-sm-3 control-label formfonterp" for="form-field-1"   style="white-space: nowrap;">                                    <strong><?php echo get_phrase('Paid Amount') ?></strong></label>                                <div class="col-sm-7">                                    <input type="text" class="form-control  required decimal" autocomplete="off"                                           placeholder="Paid Amount" id="paid_amount" name="paid_amount" value=""                                           style="color: black" onclick="this.select();"/>                                </div>                            </div>                        </div>                    </div>                    <div class="clearfix"></div>                    <div class="row" style="margin-top: 10px;">                        <div class="col-sm-12">                            <div id="voucherheader" class="table-header" style="display: none; font-weight: normal; ">                                <?php echo get_phrase('Due Voucher List') ?>                            </div>                            <span id="customer_result"></span>                        </div>                        <div class="col-sm-10 col-md-offset-1" id="narration" style="display: none;">                            <div class="form-group">                                <label class="col-sm-3 control-label no-padding-right"                                       for="form-field-1"> <?php echo get_phrase('Narration') ?></label>                                <div class="col-sm-9">                                    <div class="input-group">                                        <textarea cols="100" rows="2" name="narration" placeholder="Narration"                                                  type="text"></textarea>                                    </div>                                </div>                            </div>                        </div>                        <div class="col-sm-10 col-md-offset-1">                            <div class="clearfix form-actions" id="submitBtn" style="display: none;">                                <div class="col-md-offset-3 col-md-9">                                    <button onclick="return confirmWithValidat()" id="subBtn" class="btn btn-info"                                            type="button">                                        <i class="fa fa-check bigger-110"></i>                                        <?php echo get_phrase('Save') ?>                                    </button>                                    &nbsp; &nbsp; &nbsp;                                    <button class="btn" type="reset">                                        <i class="ace-icon fa fa-undo bigger-110"></i>                                        Reset                                    </button>                                </div>                            </div>                        </div>                    </div>                </form>            </div>        </div>    </div></div><script type="text/javascript">    function confirmWithValidat() {        var paymentType = $("input[name='payType']:checked").val();        var supplierId = $("#supplierId").val();        var paymentDate = $("#start_date").val();        var bankName = $("#bankName").val();        var branchName = $("#branchName").val();        var checkNo = $("#checkNo").val();        var checkDate = $("#checkDate").val();        var accountHead = $("#accountHead").val();        var ttl_amount = Number($(".ttl_amount ").val());        var paid_amount = parseFloat($("#paid_amount ").val());        var paidAmountSaparationn = 0;        $.each($('.amount'), function (i, elem) {            if ($(this).val() != '') {                paidAmountSaparationn = paidAmountSaparationn + parseFloat($(this).val());            }        })        if (isNaN(ttl_amount)) {            ttl_amount = 0;        }        if (supplierId == '') {            swal("Supplier Cnn't be empty!!", 'Validatin Error', 'error');        } else if (paymentDate == '') {            swal("Payment Date Can't be empty!!", 'Validatin Error', 'error');        } else if (paymentType == 2 && bankName == '') {            swal("Bank Name Can't be empty!!", 'Validatin Error', 'error');        }       /* else if (paymentType == 2 && branchName == '') {            swal("Branch Name Can't be empty!!", 'Validatin Error', 'error');        } */        else if (paymentType == 2 && checkNo == '') {            swal("Check No Can't be empty!!", 'Validatin Error', 'error');        } else if (paymentType == 2 && checkDate == '') {            swal("Check Date Can't be empty!!", 'Validatin Error', 'error');        } else if (paymentType == 1 && accountHead == '') {            swal("Account Head Can't be empty!!", 'Validatin Error', 'error');        } else if (paidAmountSaparationn != paid_amount) {            swal("Amount Can't Change!!");        } else if (ttl_amount == '') {            swal("Amount Can't be empty!!");        } else {            swal({                    title: "Are you sure ?",                    text: "You won't be able to revert this!",                    showCancelButton: true,                    confirmButtonColor: '#73AE28',                    cancelButtonColor: '#d33',                    confirmButtonText: 'Yes',                    cancelButtonText: "No",                    closeOnConfirm: true,                    closeOnCancel: true,                    type: 'success'                },                function (isConfirm) {                    if (isConfirm) {                        $("#publicForm").submit();                    } else {                        return false;                    }                });        }    }    function checkOverAmount(dynamicId) {        var paymentAmount = parseFloat($("#paymentAmount_" + dynamicId).val());        if (isNaN(paymentAmount)) {            paymentAmount = 0;        }        var dueAmount = parseFloat($("#dueAmount_" + dynamicId).val());        if (isNaN(dueAmount)) {            dueAmount = 0;        }        if (paymentAmount > dueAmount) {            $("#paymentAmount_" + dynamicId).val('');        }        var paymentType = $("input[name='payType']:checked").val();        if (paymentType == 1) {            var closeAmount = Number($("#closeAmount").val());            var accountHead = $("#accountHead").val();            var total_amount = 0;            $.each($('.amount'), function () {                amount = $(this).val();                if (isNaN(amount))                    amount = Number(amount);                total_amount += amount;            });            if (closeAmount < total_amount) {                $("#subBtn").attr('disabled', true);                $(this).val('');                swal("Account Balance Not Available!", "Validation Error", "error");                $("#paymentAmount_" + dynamicId).val('');                return false;            } else {                $("#subBtn").attr('disabled', false);            }            checkNotEmptyAmount();        } else {            checkNotEmptyAmount();        }    }    function checkNotEmptyAmount() {        var totalVoucherPayment = 0;        $.each($('.amount'), function () {            voucherAmount = $(this).val();            if (isNaN(voucherAmount)) {                $(this).val('');                voucherAmount = 0;            }            voucherAmount = Number(voucherAmount);            totalVoucherPayment += voucherAmount;        });        if (totalVoucherPayment > 0) {            $("#subBtn").attr('disabled', false);        } else {            $("#subBtn").attr('disabled', true);        }    }    function showBankinfo(id) {        if (id == 1) {            $("#cashInfo").show(10);        } else {            $("#showBankInfo").hide(10);        }        if (id == 2) {            $("#showBankInfo").show(10);            $("#cashInfo").hide(10)        } else {            $("#showBankInfo").show(10)            $("#showBankInfo").hide(10);        }    }    function getBankBranch(id) {        $('#branchName').html('');        if (id != '') {            $.ajax({                type: "POST",                url: baseUrl + "lpg/SalesController/getbankbranchList",                data: 'bank_id=' + id,                dataType: 'json',                success: function (data) {                    console.log(data);                    var option = "";                    option += "<option value='" + '' + "'>---Select Name---</option>";                    $.each(data, function (key, value) {                        option += "<option   value='" + value.bank_branch_id + "'  >" + value.bank_branch_name + "</option>";                    });                    $('#branchName').html(option);                }            });        }    }    $(document).ready(function () {        $('.supplierid').change(function () {            get_invoice_list();            //$('#BranchAutoId').chosen();            //$('#BranchAutoId').focus();        });        $('#BranchAutoId').change(function () {            get_invoice_list();        });        function get_invoice_list(){            var supplier = $('.supplierid').val();            var BranchAutoId = $('#BranchAutoId').val();            $('#paid_amount').val('');            if (BranchAutoId == '' || BranchAutoId == 0 || BranchAutoId == null) {            }else if (supplier == '' || supplier == 0 || supplier == null) {            } else {                $.ajax({                    type: 'POST',                    data: {supplier: supplier,BranchAutoId:BranchAutoId},                    url: '<?php echo site_url("lpg/InventoryController/suppay_ajax"); ?>',                    success: function (result) {                        $("#submitBtn").show(1000);                        $("#voucherheader").show(1000);                        $("#narration").show(1000);                        $('#customer_result').html(result);                    }                });            }        }        $('.checkAccountBalance').change(function () {            var accountId = $(this).val();            $.ajax({                type: 'POST',                data: {account: accountId},                url: '<?php echo site_url("lpg/FinaneController/checkBalance"); ?>',                success: function (result) {                    $('#accountBalance').html('');                    $('#accountBalance').html(result);                }            });        });    });    $("#paid_amount").keyup(function (event) {        var number = $("#customer_mobile").val();        if (event.keyCode == 13) {            adjustamount(number);        }    });    function adjustamount(number) {        $('.amount').val('');        $('#currentDueAmount').val();        var paid_amount = parseFloat($('#paid_amount').val());        $('.ttl_amount').val(paid_amount);        var totalDueAmount=$('#totalDueAmount').val();        totalDueAmount=parseFloat(totalDueAmount);        var advance_amount = 0;        if (isNaN(advance_amount)) {            advance_amount = 0;        }        $('#currentDueAmount').val(totalDueAmount-paid_amount);        $.each($('.invoice_id'), function (i, elem) {            var sales_invoice_id = $(this).val();            var amount = parseFloat($('#dueAmount_' + sales_invoice_id).val());            if (paid_amount > amount && paid_amount > 0) {                $('#paymentAmount_' + sales_invoice_id).val(amount);            } else if (paid_amount < amount && paid_amount > 0) {                $('#paymentAmount_' + sales_invoice_id).val(paid_amount);            } else if (paid_amount == amount && paid_amount > 0) {                $('#paymentAmount_' + sales_invoice_id).val(paid_amount);            }            paid_amount = paid_amount - amount;        });        if (paid_amount > 0) {            advance_amount + paid_amount;        }    }    $("#adjust_payment").bind("click", function () {        var paid_amount = parseFloat($('#paid_amount').val());        var advance_amount = parseFloat($('#advance_amount').val());        if (isNaN(advance_amount)) {            advance_amount = 0;        }        $.each($('.invoice_id'), function (i, elem) {            var sales_invoice_id = $(this).val();            var amount = parseFloat($('#dueAmount_' + sales_invoice_id).val());            if (paid_amount > amount && paid_amount > 0) {                $('#paymentAmount_' + sales_invoice_id).val(amount);            } else if (paid_amount < amount && paid_amount > 0) {                $('#paymentAmount_' + sales_invoice_id).val(paid_amount);            } else if (paid_amount == amount && paid_amount > 0) {                $('#paymentAmount_' + sales_invoice_id).val(paid_amount);            }            paid_amount = paid_amount - amount;            //for advance        });        if (paid_amount > 0) {            advance_amount + paid_amount;        }        $('#ttl_amount').val(advance_amount + paid_amount);    });</script><script>    $(document).ready(function () {        $('.date-picker').datepicker({            autoclose: true,            todayHighlight: true        })    });    /*$(document).ready(function () {        $('.amount').change(function () {            ttl_amount = 0;            var thisValue = 0;            if ($(this).val() != '') {                thisValue = $(this).val();            }            $.each($('.amount'), function () {                aamount = $(this).val();                aamount = Number(aamount);                ttl_amount += aamount;            });            $(this).val(parseFloat(thisValue).toFixed(2));            $('.ttl_amount').val(parseFloat(ttl_amount).toFixed(2));        });    });*/</script>